Oui bien sÃ»râ€¯! Sur la Raspberry Pi, lire les donnÃ©es d une Arduino connectÃ©e en USB est trÃ¨s simple. L Arduino se comporte comme un pÃ©riphÃ©rique sÃ©rie (TTY) une fois branchÃ©.

âœ… 1. Connexion de l Arduino Ã  la Raspberry Pi (via USB)
Quand tu branches ton Arduino Ã  la Raspberry via un cÃ¢ble USB, il est reconnu comme un port sÃ©rie (typiquement /dev/ttyUSB0 ou /dev/ttyACM0).

ğŸ” 2. VÃ©rifier le port sÃ©rie utilisÃ©
Dans le terminal de la Raspberry Pi :

bash
Copier
Modifier
ls /dev/ttyUSB* /dev/ttyACM*
Tu verras par exemple :

bash
Copier
Modifier
/dev/ttyUSB0
ğŸ’¡ Ce chemin est celui que tu utiliseras dans ton script Python.

ğŸ 3. Lire les donnÃ©es envoyÃ©es par l Arduino (Python)
Voici un petit code Python fonctionnel sur la Raspberry pour lire ce que lâ€™Arduino envoie :

python
Copier
Modifier
import serial
import time

# Adapter le port si nÃ©cessaire
arduino = serial.Serial('/dev/ttyUSB0', 9600, timeout=1)
time.sleep(2)  # Attendre que la connexion soit prÃªte

print("ğŸ“¡ Lecture en cours depuis l'Arduino...")

try:
    while True:
        ligne = arduino.readline().decode().strip()
        if ligne:
            print(f"ğŸ“¥ ReÃ§u : {ligne}")
except KeyboardInterrupt:
    print("ğŸ›‘ Fin de lecture.")
finally:
    arduino.close()
ğŸ› ï¸ 4. Code Arduino exemple (pour tester)
Voici un sketch Arduino que tu peux tÃ©lÃ©verser pour tester :

cpp
Copier
Modifier
void setup() {
  Serial.begin(9600);
}

void loop() {
  float distance = 123.4; // Exemple de valeur
  Serial.println("AV:" + String(distance));
  delay(1000); // Envoie toutes les secondes
}
ğŸ” RÃ©sultat cÃ´tÃ© Raspberry :
r
Copier
Modifier
ğŸ“¥ ReÃ§u : AV:123.4
ğŸ“¥ ReÃ§u : AV:123.4
ğŸ“¥ ReÃ§u : AV:123.4
Souhaites-tu ensuite que je tâ€™aide Ã  envoyer ces valeurs Ã  ton PC, ou tu veux d abord tester la lecture sÃ©rie sur ta Pi ?







Vous avez ditÂ :
envoie les au pc


ChatGPT a ditÂ :
TrÃ¨s bien ! Pour envoyer les donnÃ©es lues depuis l Arduino vers ton PC, on va faire en sorte que la Raspberry Pi fonctionne comme un serveur HTTP, et le PC sera le client qui va rÃ©cupÃ©rer ces donnÃ©es via une requÃªte HTTP.

ğŸ§  SchÃ©ma global :
Arduino â†’ Raspberry Pi : Arduino envoie les donnÃ©es via le port sÃ©rie.

Raspberry Pi â†’ PC : Raspberry Pi expose les donnÃ©es via un serveur HTTP.

PC â†’ Raspberry Pi : Le PC interroge rÃ©guliÃ¨rement la Raspberry Pi pour obtenir les distances.

âœ… Ã‰tape 1 : Sur la Raspberry Pi (serveur HTTP avec Flask)
1.1 Installer Flask
Si tu n as pas encore installÃ© Flask, tu peux le faire avec :

bash
Copier
Modifier
sudo apt update
sudo apt install python3-pip
pip3 install flask
1.2 Code Flask pour Raspberry Pi
Voici un serveur simple avec Flask qui lit les donnÃ©es sÃ©rie depuis l Arduino et les expose en HTTP :

python
Copier
Modifier
import serial
import time
from flask import Flask, jsonify

app = Flask(__name__)

# Connecter l'Arduino au port sÃ©rie
arduino = serial.Serial('/dev/ttyUSB0', 9600, timeout=1)
time.sleep(2)  # Attendre la connexion

# Fonction pour rÃ©cupÃ©rer les donnÃ©es de l'Arduino
def get_distance():
    try:
        line = arduino.readline().decode().strip()
        if line:
            capteur, valeur = line.split(":")
            return {capteur: float(valeur)}
        return {"error": "Aucune donnÃ©e reÃ§ue"}
    except:
        return {"error": "Erreur de lecture"}

@app.route("/distance", methods=["GET"])
def distance():
    data = get_distance()
    return jsonify(data)

if __name__ == "__main__":
    app.run(host='0.0.0.0', port=5000)  # Serveur accessible depuis le rÃ©seau
Explication :
La Raspberry Pi lit les donnÃ©es sÃ©rie depuis l Arduino (/dev/ttyUSB0).

Lorsqu une requÃªte GET est envoyÃ©e sur /distance, elle renvoie les donnÃ©es sous forme de JSON.

Le serveur Flask Ã©coute sur le port 5000 (accessible sur le rÃ©seau local).

Lancer le serveur sur la Raspberry Pi :
bash
Copier
Modifier
python3 serveur.py
Le serveur devrait maintenant Ãªtre accessible via l IP de la Raspberry Pi, par exemple http://192.168.1.42:5000/distance.

âœ… Ã‰tape 2 : Sur le PC (client HTTP pour rÃ©cupÃ©rer les distances)
Sur le PC, tu peux utiliser un client HTTP (par exemple avec requests en Python) pour interroger la Raspberry Pi et rÃ©cupÃ©rer les donnÃ©es des capteurs.

2.1 Installer requests
Si tu n as pas encore requests :

bash
Copier
Modifier
pip install requests
2.2 Code Python pour interroger la Raspberry Pi
Voici le code sur le PC pour rÃ©cupÃ©rer les distances depuis la Raspberry Pi :

python
Copier
Modifier
import requests
import time

# Adresse IP de la Raspberry Pi et port du serveur
rasp_ip = "http://192.168.1.42:5000/distance"  # Changez l'IP si nÃ©cessaire

while True:
    try:
        response = requests.get(rasp_ip)
        data = response.json()
        print(f"ğŸ“¦ DonnÃ©e reÃ§ue : {data}")
    except Exception as e:
        print(f"âŒ Erreur lors de la rÃ©cupÃ©ration des donnÃ©es : {e}")
    
    time.sleep(1)  # Demander toutes les secondes
Explication :
Ce code envoie une requÃªte HTTP GET Ã  la Raspberry Pi pour rÃ©cupÃ©rer les donnÃ©es de distance.

Si tout va bien, il affiche la distance reÃ§ue.

Il rÃ©pÃ¨te cette action toutes les secondes.

ğŸ› ï¸ Tester l ensemble :
Lancer le serveur sur la Raspberry Pi : python3 serveur.py

Lancer le client sur le PC : python3 client.py

Si tout est correctement configurÃ©, tu devrais voir les distances des capteurs s afficher toutes les secondes sur ton PC.

ğŸ”„ RÃ©sumÃ© du fonctionnement :
Arduino â†’ Raspberry Pi : Arduino envoie les distances via sÃ©rie (port USB).

Raspberry Pi â†’ PC : Raspberry Pi expose les donnÃ©es via un serveur HTTP Flask.

PC â†’ Raspberry Pi : Le PC envoie des requÃªtes HTTP pour rÃ©cupÃ©rer les distances.